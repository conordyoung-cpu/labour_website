<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Labour Hire System</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="assets/css/styles.css" />

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAuth } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
    import { getFirestore, doc, setDoc, getDoc, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
    import * as authFunctions from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDRHNIkKWuGDpID76Kn8r-6oU2cco6ga_c",
      authDomain: "labour-hire-app.firebaseapp.com",
      projectId: "labour-hire-app",
      storageBucket: "labour-hire-app.appspot.com",
      messagingSenderId: "348482727709",
      appId: "1:348482727709:web:3fba6f9fc7f8b4efa6fbf4"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // This makes the services available to your other files
    window.__services = { 
      app, auth, db, 
      FB: { ...authFunctions, doc, setDoc, getDoc, collection, getDocs } 
    };
    
    // 2. NOW LOAD THE MAIN APP
    import("./assets/js/main.js");
  </script>
</head>

<body class="bg-gray-100 text-gray-800">
  <div id="app" class="container mx-auto p-4">

    <div id="main-nav" class="hidden bg-white rounded-lg shadow p-4 mb-6 flex justify-between items-center">
      <h1 class="text-xl font-bold text-gray-700">Labour Management</h1>
      <button id="logout-btn" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg">Logout</button>
    </div>

    <div id="kiosk-view" class="bg-gray-200 p-10 rounded-xl text-center">
      <h1 class="text-4xl font-bold mb-10">Business Name</h1>
      <button id="login-btn" class="bg-blue-600 text-white font-bold py-4 px-10 rounded-lg text-xl m-2">Login</button>
      <button id="time-clock-btn" class="bg-green-500 text-white font-bold py-4 px-10 rounded-lg text-xl m-2">Time Clock</button>
    </div>

    <div id="login-view" class="hidden max-w-md mx-auto bg-white p-8 rounded-lg shadow-md mt-10">
      <h2 class="text-2xl font-bold text-center mb-6">Login</h2>
      <input type="email" id="login-email" class="w-full p-3 border rounded mb-4" placeholder="Email">
      <input type="password" id="login-password" class="w-full p-3 border rounded mb-6" placeholder="Password">
      <button id="login-submit-btn" class="w-full bg-blue-500 text-white font-bold py-3 rounded mb-3">Sign In</button>
      <button id="go-to-signup-btn" class="w-full bg-green-500 text-white font-bold py-3 rounded mb-3">Create Account</button>
      <button id="back-to-kiosk-from-login-btn" class="w-full text-gray-500">Back</button>
    </div>

    <div id="signup-view" class="hidden max-w-md mx-auto bg-white p-8 rounded-lg shadow-md mt-10">
      <h2 class="text-2xl font-bold mb-6 text-center">Worker Sign Up</h2>
      <input type="text" id="signup-name" placeholder="Full Name" class="w-full p-3 border rounded mb-4">
      <input type="email" id="signup-email" placeholder="Email" class="w-full p-3 border rounded mb-4">
      <input type="password" id="signup-password" placeholder="Password (min 6 chars)" class="w-full p-3 border rounded mb-6">
      <button id="finish-signup-btn" class="w-full bg-green-600 text-white font-bold py-3 rounded">Finish Registration</button>
      <button id="back-to-login-btn" class="w-full text-gray-500 mt-4">Back to Login</button>
    </div>

    <div id="worker-dashboard-view" class="hidden">
      <div class="bg-blue-600 text-white p-4 rounded-t-lg flex justify-around">
        <button class="worker-nav-btn font-bold" data-target="worker-clock">Clock</button>
        <button class="worker-nav-btn font-bold" data-target="worker-schedule">Schedule</button>
      </div>
      <div class="bg-white p-6 rounded-b-lg shadow min-h-[300px]">
        <div id="worker-clock" class="worker-section text-center">
          <button class="bg-green-500 p-10 rounded-full text-white font-bold text-xl">CLOCK IN</button>
        </div>
        <div id="worker-schedule" class="worker-section hidden">
          <p>No shifts scheduled.</p>
        </div>
      </div>
    </div>

    <div id="admin-dashboard-view" class="hidden">
      <h2 class="text-2xl font-bold mb-4">Admin Panel</h2>
      <nav class="flex space-x-4 mb-6">
        <button class="admin-nav-btn bg-white p-2 rounded shadow" data-target="employee-list-section">Employees</button>
      </nav>
      <div id="employee-list-section" class="admin-section">
        <table class="w-full bg-white rounded shadow">
          <thead><tr class="bg-gray-100 text-left"><th class="p-3">Name</th><th class="p-3">Role</th></tr></thead>
          <tbody id="employee-table-body"></tbody>
        </table>
      </div>
    </div>

  </div>

  <div id="message-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
    <div class="bg-white p-8 rounded-lg shadow-lg text-center max-w-sm">
      <p id="message-text" class="mb-6"></p>
      <button id="close-message-modal-btn" class="bg-blue-500 text-white px-6 py-2 rounded">OK</button>
    </div>
  </div>

</body>
</html>
